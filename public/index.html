<html lang="en">
  <head>
    <link href="https://fonts.googleapis.com/css?family=Fjalla+One|Open+Sans" rel="stylesheet">
    <title>CS4241 Assignment 2</title>
    <meta charset="utf-8">
    <!-- Start Added by Ian -->
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="https://d3js.org/topojson.v2.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <!-- End Added by Ian -->
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <link href="/d3-geomap/css/d3.geomap.css" rel="stylesheet">

    <script type="text/javascript">
      var nuclearInvData = [];

          // Fancy thing.
      if( localStorage && localStorage.getItem('nuclearInvData') ) {
      console.log('loading from local');
      buildList( JSON.parse(localStorage.getItem('nuclearInvData')) )
      } else {
      console.log('loading from server');
      getJSON('/worldNuclearInventory');
      }

      function getJSON(url) {
      var req = new XMLHttpRequest();
      req.onreadystatechange = function() {
        handleRes(req);
      }

      req.open('GET', url);
      req.send();
      }

      function handleRes(req) {
        if( req.readyState !== XMLHttpRequest.DONE )
        return;

        if(req.status === 200) {
          var nuclearInvData = JSON.parse(req.responseText);
          localStorage.setItem('nuclearInvData', req.responseText);
        }
      }
    </script>
  </head>

  <body>
    <div></div>
  </body>
</html>
